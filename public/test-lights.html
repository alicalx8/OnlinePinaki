<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IÅŸÄ±k Sistemi Test - GeliÅŸmiÅŸ</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .test-container {
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button.danger {
            background: #dc3545;
        }
        .test-button.danger:hover {
            background: #c82333;
        }
        .player-box {
            display: inline-block;
            width: 150px;
            height: 100px;
            margin: 10px;
            border: 2px solid #ccc;
            border-radius: 10px;
            text-align: center;
            line-height: 100px;
            font-weight: bold;
            position: relative;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
        }
        .light-status {
            margin: 10px 0;
            padding: 10px;
            background: #fff;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        .console {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            max-height: 200px;
            overflow-y: auto;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ® IÅŸÄ±k Sistemi Test - GeliÅŸmiÅŸ</h1>
        
        <div class="status">
            <h3>ğŸ“Š Test Durumu:</h3>
            <p><strong>Ä°hale Aktif:</strong> <span id="auction-status">HayÄ±r</span></p>
            <p><strong>Ä°hale SÄ±rasÄ±:</strong> <span id="auction-current">-</span></p>
            <p><strong>Kart Atma SÄ±rasÄ±:</strong> <span id="current-player">-</span></p>
        </div>
        
        <div class="light-status">
            <h3>ğŸ’¡ IÅŸÄ±k Durumu:</h3>
            <div id="light-status-display">TÃ¼m Ä±ÅŸÄ±klar kapalÄ±</div>
        </div>
        
        <div>
            <h3>ğŸ‘¥ Oyuncu KutularÄ±:</h3>
            <div id="player1" class="player-box">Oyuncu 1</div>
            <div id="player2" class="player-box">Oyuncu 2</div>
            <div id="player3" class="player-box">Oyuncu 3</div>
            <div id="player4" class="player-box">Oyuncu 4</div>
        </div>
        
        <div style="margin-top: 30px;">
            <h3>ğŸ§ª Test ButonlarÄ±:</h3>
            <button class="test-button" onclick="testAuctionMode()">ğŸŸ¡ Ä°hale Modu BaÅŸlat</button>
            <button class="test-button" onclick="testCardPlayMode()">ğŸ”µ Kart Atma Modu</button>
            <button class="test-button" onclick="testEndAuction()">â¹ï¸ Ä°haleyi Bitir</button>
            <button class="test-button" onclick="testEndGame()">ğŸ Oyunu Bitir</button>
            <button class="test-button danger" onclick="clearAllLights()">ğŸ§¹ TÃ¼m IÅŸÄ±klarÄ± Temizle</button>
        </div>
        
        <div style="margin-top: 20px;">
            <h3>ğŸ´ Deal Button Test:</h3>
            <button class="test-button" onclick="testDealButton()">ğŸ” Deal Button Durumunu Test Et</button>
            <button class="test-button" onclick="changeCurrentPlayer()">ğŸ‘¤ Mevcut Oyuncuyu DeÄŸiÅŸtir</button>
            <div id="deal-button-status" style="margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 5px; font-family: monospace;"></div>
        </div>
        
        <div style="margin-top: 20px;">
            <h3>ğŸŒ Online Mod SimÃ¼lasyonu:</h3>
            <button class="test-button" onclick="simulateCardsDealt()">ğŸ´ KartlarÄ± DaÄŸÄ±t (4. Oyuncu)</button>
            <button class="test-button" onclick="simulateAuctionStart()">ğŸš€ Ä°haleyi BaÅŸlat</button>
            <button class="test-button" onclick="simulateNextBidder()">â­ï¸ SÄ±radaki TeklifÃ§i</button>
        </div>
        
        <div class="status">
            <h3>âœ… Beklenen DavranÄ±ÅŸ:</h3>
            <ul>
                <li><strong>ğŸŸ¡ Ä°hale Modu:</strong> Sadece sÄ±radaki oyuncunun kutusu sarÄ± yanmalÄ±</li>
                <li><strong>ğŸ”µ Kart Atma Modu:</strong> Sadece sÄ±radaki oyuncunun kutusu mavi yanmalÄ±</li>
                <li><strong>â¹ï¸ Ä°hale Bitti:</strong> SarÄ± Ä±ÅŸÄ±k sÃ¶nmeli, mavi Ä±ÅŸÄ±k aktif olmalÄ±</li>
                <li><strong>ğŸ Oyun Bitti:</strong> TÃ¼m Ä±ÅŸÄ±klar sÃ¶nmeli</li>
                <li><strong>ğŸš« Ã–NEMLÄ°:</strong> AynÄ± anda sadece bir Ä±ÅŸÄ±k yanmalÄ±!</li>
            </ul>
        </div>
        
        <div class="console" id="console">
            <div>ğŸ¯ Test konsolu baÅŸlatÄ±ldÄ±...</div>
        </div>
    </div>

    <script>
        // Global deÄŸiÅŸkenler
        window.auctionActive = false;
        window.auctionCurrent = 0;
        window.currentPlayer = 0;
        
        function log(message) {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            console.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }
        
        function updateStatus() {
            document.getElementById('auction-status').textContent = window.auctionActive ? 'Evet' : 'HayÄ±r';
            document.getElementById('auction-current').textContent = window.auctionActive ? (window.auctionCurrent + 1) : '-';
            document.getElementById('current-player').textContent = window.currentPlayer + 1;
        }
        
        function updateLightStatus() {
            const lightStatus = document.getElementById('light-status-display');
            let status = '';
            let activeLights = 0;
            
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                if (playerDiv.classList.contains('auction-active')) {
                    status += `Oyuncu ${i}: ğŸŸ¡ SarÄ± | `;
                    activeLights++;
                } else if (playerDiv.classList.contains('active-player')) {
                    status += `Oyuncu ${i}: ğŸ”µ Mavi | `;
                    activeLights++;
                }
            }
            
            if (activeLights === 0) {
                status = 'TÃ¼m Ä±ÅŸÄ±klar kapalÄ±';
            } else if (activeLights > 1) {
                status = `âš ï¸ HATA: ${activeLights} Ä±ÅŸÄ±k aynÄ± anda yanÄ±yor! ` + status;
            }
            
            lightStatus.innerHTML = status;
        }
        
        function testAuctionMode() {
            log('ğŸŸ¡ Ä°hale modu test ediliyor...');
            
            window.auctionActive = true;
            window.auctionCurrent = 0;
            updateStatus();
            
            // Ã–nce tÃ¼m Ä±ÅŸÄ±klarÄ± temizle
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                playerDiv.classList.remove('active-player', 'auction-active');
            }
            
            // Ä°hale sÃ¼recinde sadece sarÄ± Ä±ÅŸÄ±k (auction-active)
            const auctionPlayerDiv = document.getElementById(`player${window.auctionCurrent + 1}`);
            if (auctionPlayerDiv) {
                auctionPlayerDiv.classList.add('auction-active');
                log(`âœ… Oyuncu ${window.auctionCurrent + 1} sarÄ± Ä±ÅŸÄ±kla iÅŸaretlendi`);
            }
            
            updateLightStatus();
            log('ğŸŸ¡ Ä°hale modu baÅŸlatÄ±ldÄ±');
        }
        
        function testCardPlayMode() {
            log('ğŸ”µ Kart atma modu test ediliyor...');
            
            window.auctionActive = false;
            window.currentPlayer = 2;
            updateStatus();
            
            // Ã–nce tÃ¼m Ä±ÅŸÄ±klarÄ± temizle
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                playerDiv.classList.remove('active-player', 'auction-active');
            }
            
            // Kart atma sÄ±rasÄ±nda sadece mavi Ä±ÅŸÄ±k (active-player)
            const cardPlayerDiv = document.getElementById(`player${window.currentPlayer + 1}`);
            if (cardPlayerDiv) {
                cardPlayerDiv.classList.add('active-player');
                log(`âœ… Oyuncu ${window.currentPlayer + 1} mavi Ä±ÅŸÄ±kla iÅŸaretlendi`);
            }
            
            updateLightStatus();
            log('ğŸ”µ Kart atma modu baÅŸlatÄ±ldÄ±');
        }
        
        function testEndAuction() {
            log('â¹ï¸ Ä°hale bitirme test ediliyor...');
            
            window.auctionActive = false;
            updateStatus();
            
            // Ä°hale bittiÄŸinde tÃ¼m sarÄ± Ä±ÅŸÄ±klarÄ± kapat
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                if (playerDiv) {
                    playerDiv.classList.remove('auction-active');
                }
            }
            
            updateLightStatus();
            log('â¹ï¸ Ä°hale bitti - SarÄ± Ä±ÅŸÄ±klar sÃ¶ndÃ¼');
        }
        
        function testEndGame() {
            log('ğŸ Oyun bitirme test ediliyor...');
            
            window.auctionActive = false;
            window.currentPlayer = null;
            updateStatus();
            
            // Oyun bittiÄŸinde tÃ¼m Ä±ÅŸÄ±klarÄ± kapat
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                if (playerDiv) {
                    playerDiv.classList.remove('active-player', 'auction-active');
                }
            }
            
            updateLightStatus();
            log('ğŸ Oyun bitti - TÃ¼m Ä±ÅŸÄ±klar sÃ¶ndÃ¼');
        }
        
        function clearAllLights() {
            log('ğŸ§¹ TÃ¼m Ä±ÅŸÄ±klar temizleniyor...');
            
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                if (playerDiv) {
                    playerDiv.classList.remove('active-player', 'auction-active');
                }
            }
            
            window.auctionActive = false;
            window.auctionCurrent = 0;
            window.currentPlayer = 0;
            updateStatus();
            updateLightStatus();
            
            log('ğŸ§¹ TÃ¼m Ä±ÅŸÄ±klar temizlendi');
        }
        
        // Online mod simÃ¼lasyonu
        function simulateCardsDealt() {
            log('ğŸ´ Kartlar daÄŸÄ±tÄ±lÄ±yor (4. oyuncu daÄŸÄ±tÄ±cÄ±)...');
            
            // 4. oyuncu daÄŸÄ±tÄ±cÄ± olsun
            window.currentDealer = 3; // 4. oyuncu (index 3)
            log(`âœ… DaÄŸÄ±tÄ±cÄ±: Oyuncu ${window.currentDealer + 1}`);
            
            updateStatus();
        }
        
        function simulateAuctionStart() {
            log('ğŸš€ Ä°hale baÅŸlatÄ±lÄ±yor...');
            
            // DaÄŸÄ±tÄ±cÄ±dan sonraki oyuncu ihale baÅŸlatÄ±r
            window.auctionCurrent = (window.currentDealer + 1) % 4; // 1. oyuncu (index 0)
            window.auctionActive = true;
            
            log(`âœ… Ä°hale baÅŸladÄ± - SÄ±ra: Oyuncu ${window.auctionCurrent + 1}`);
            
            // ArayÃ¼zÃ¼ gÃ¼ncelle
            updateStatus();
            
            // Ã–nce tÃ¼m Ä±ÅŸÄ±klarÄ± temizle
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                playerDiv.classList.remove('active-player', 'auction-active');
            }
            
            // Ä°hale sÃ¼recinde sadece auctionCurrent sarÄ± yansÄ±n
            const auctionPlayerDiv = document.getElementById(`player${window.auctionCurrent + 1}`);
            if (auctionPlayerDiv) {
                auctionPlayerDiv.classList.add('auction-active');
                log(`ğŸŸ¡ Oyuncu ${window.auctionCurrent + 1} sarÄ± Ä±ÅŸÄ±kla iÅŸaretlendi`);
            }
            
            updateLightStatus();
            log('ğŸš€ Ä°hale baÅŸlatÄ±ldÄ± - Sadece 1. oyuncu teklif verebilir');
        }
        
        function simulateNextBidder() {
            if (!window.auctionActive) {
                log('âŒ Ä°hale aktif deÄŸil!');
                return;
            }
            
            log('â­ï¸ SÄ±radaki teklifÃ§iye geÃ§iliyor...');
            
            // SÄ±radaki oyuncuya geÃ§
            window.auctionCurrent = (window.auctionCurrent + 1) % 4;
            
            log(`âœ… SÄ±ra: Oyuncu ${window.auctionCurrent + 1}`);
            
            // ArayÃ¼zÃ¼ gÃ¼ncelle
            updateStatus();
            
            // Ã–nce tÃ¼m Ä±ÅŸÄ±klarÄ± temizle
            for (let i = 1; i <= 4; i++) {
                const playerDiv = document.getElementById(`player${i}`);
                playerDiv.classList.remove('active-player', 'auction-active');
            }
            
            // Ä°hale sÃ¼recinde sadece auctionCurrent sarÄ± yansÄ±n
            const auctionPlayerDiv = document.getElementById(`player${window.auctionCurrent + 1}`);
            if (auctionPlayerDiv) {
                auctionPlayerDiv.classList.add('auction-active');
                log(`ğŸŸ¡ Oyuncu ${window.auctionCurrent + 1} sarÄ± Ä±ÅŸÄ±kla iÅŸaretlendi`);
            }
            
            updateLightStatus();
            log(`â­ï¸ SÄ±ra Oyuncu ${window.auctionCurrent + 1}'e geÃ§ti`);
        }
        
        // Deal button test fonksiyonlarÄ±
        function testDealButton() {
            const dealBtn = document.getElementById('dealBtn');
            const statusDiv = document.getElementById('deal-button-status');
            
            if (!dealBtn) {
                statusDiv.innerHTML = 'âŒ Deal button bulunamadÄ±!';
                return;
            }
            
            const currentPlayer = window.currentPlayer !== undefined ? window.currentPlayer : 'TanÄ±msÄ±z';
            const currentDealer = window.currentDealer !== undefined ? window.currentDealer : 'TanÄ±msÄ±z';
            const isCurrentPlayerDealer = window.currentPlayer === window.currentDealer;
            const isDisabled = dealBtn.disabled;
            const opacity = dealBtn.style.opacity;
            const cursor = dealBtn.style.cursor;
            const backgroundColor = dealBtn.style.backgroundColor;
            
            statusDiv.innerHTML = `
                <strong>Deal Button Durumu:</strong><br>
                ğŸ“ Mevcut Oyuncu: ${currentPlayer + 1} (index: ${currentPlayer})<br>
                ğŸ¯ DaÄŸÄ±tÄ±cÄ±: ${currentDealer + 1} (index: ${currentDealer})<br>
                âœ… Oyuncu DaÄŸÄ±tÄ±cÄ± mÄ±: ${isCurrentPlayerDealer ? 'Evet' : 'HayÄ±r'}<br>
                ğŸ”’ Buton Devre DÄ±ÅŸÄ±: ${isDisabled ? 'Evet' : 'HayÄ±r'}<br>
                ï¿½ï¿½ Opacity: ${opacity}<br>
                ğŸ‘† Cursor: ${cursor}<br>
                ğŸŒˆ Background: ${backgroundColor}<br>
                ğŸ“ Text: ${dealBtn.textContent}<br>
                ğŸ’¡ Title: ${dealBtn.title}
            `;
            
            log(`ğŸ” Deal button test edildi - Oyuncu ${currentPlayer + 1}, DaÄŸÄ±tÄ±cÄ± ${currentDealer + 1}, Aktif: ${!isDisabled}`);
        }
        
        function changeCurrentPlayer() {
            if (window.currentPlayer === undefined) {
                window.currentPlayer = 0;
            } else {
                window.currentPlayer = (window.currentPlayer + 1) % 4;
            }
            
            log(`ğŸ‘¤ Mevcut oyuncu deÄŸiÅŸtirildi: Oyuncu ${window.currentPlayer + 1}`);
            updateStatus();
            
            // Deal button durumunu gÃ¼ncelle
            if (window.setupDealButton) {
                // setupDealButton fonksiyonunu Ã§aÄŸÄ±r
                window.setupDealButton();
            } else {
                // Manuel olarak gÃ¼ncelle
                const dealBtn = document.getElementById('dealBtn');
                if (dealBtn && window.currentDealer !== undefined) {
                    const isCurrentPlayerDealer = window.currentPlayer === window.currentDealer;
                    if (!isCurrentPlayerDealer) {
                        dealBtn.disabled = true;
                        dealBtn.style.opacity = '0.5';
                        dealBtn.style.cursor = 'not-allowed';
                        dealBtn.style.backgroundColor = '#ccc';
                    } else {
                        dealBtn.disabled = false;
                        dealBtn.style.opacity = '1';
                        dealBtn.style.cursor = 'pointer';
                        dealBtn.style.backgroundColor = '';
                    }
                }
            }
            
            testDealButton();
        }
        
        // Sayfa yÃ¼klendiÄŸinde durumu gÃ¼ncelle
        updateStatus();
        updateLightStatus();
        testDealButton(); // Deal button durumunu da test et
        log('ğŸ® Test sayfasÄ± yÃ¼klendi ve hazÄ±r!');
    </script>
</body>
</html>
